

CREATE COMPUTE MODULE MF_SonarTest_Compute
	CREATE FUNCTION Main() RETURNS BOOLEAN
	BEGIN
		CALL CopyMessageHeaders();
		CALL CopyEntireMessage();
		PROPAGATE DELETE NONE; --Compliant
		RETURN TRUE; --Compliant
	END;

	CREATE PROCEDURE CopyMessageHeaders() BEGIN
		PROPAGATE TO TERMINAL 'out1' DELETE NONE; --Noncompliant
		PROPAGATE TO TERMINAL 'out2' DELETE NONE; --Noncompliant
		PROPAGATE TO LABEL 'out2' DELETE NONE; --Compliant
	END;

	CREATE PROCEDURE CopyEntireMessage() BEGIN
		PROPAGATE TO TERMINAL 0 DELETE NONE; --Compliant
		PROPAGATE TO TERMINAL 3 DELETE NONE; --Noncompliant
		PROPAGATE TO TERMINAL -1 DELETE NONE; --Noncompliant
	END;
END MODULE;
